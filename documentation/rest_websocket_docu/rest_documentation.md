# REST documentation
This documentation describes all REST routes including response structure and success / error codes.

## Hint
In addition to REST request responses, some routes result in messages broadcasted using websockets (See `websocket_documentation.md`).

## Response structure
The response structure of a successful request looks like this:
```json
{
    'status' => 200,
    'error' => null,
    'data' => [],
    'timestamp' => '2019-07-04T13:33:03.969Z'
}
```
The `status` property always equals the response status code (For some languages it is easier to access the body than the status code). The `error` property contains an error if the request was unsuccessful; this could either be a string or a json object. The `data` property contains the response data; this could either be a json object or an array of json objects (depending on the action performed). The `timestamp` property contains the timestamp when the request leaves the application.  

Depending on what action is performed, the status code may differ (e.g. 201 - Created, 400 - Bad Request, ...). Either `error` or `data` has to be `null`.

## Routes

Below is a table containing all available REST api routes. `AUTH` states if the user has to be authenticated or not. `ROLE` states which role is at least required to perform the action; specific authorization checks (e.g. "A team may only be modified by its creator") are not considered. The `ERROR-STATUS` does not consider general error responses like `500 - Internal Server Error` or `503 - Service unavailable`. 

BASE: `localhost/api/v1`

| GROUP      | METHOD | PATH                                     | AUTH  | ROLE           | DESCRIPTION                                                                                                                              | SUCCESS-STATUS   | ERROR-STATUS                                                          |
|------------|--------|------------------------------------------|-------|----------------|------------------------------------------------------------------------------------------------------------------------------------------|------------------|-----------------------------------------------------------------------|
| AUTH       | GET    | {BASE}/auth/me                           | TRUE  | everyone       | Returns current authenticated user                                                                                                       | 200 - OK         | 401 - Unauthenticated                                                 |
| AUTH       | -      | TODO: Add auth routes according to <br/>auth protocol used|| - | - | - | - | - |
| USER       | GET    | {BASE}/users                             | TRUE  | admin, manager | Returns all users                                                                                                                        | 200 - OK         | 401 - Unauthenticated<br/>403 - Unauthorized                          |
|            | POST   | {BASE}/users                             | FALSE | everyone       | Creates user                                                                                                                             | 201 - Created    | 400 - Input invalid                                                   |
|            | GET    | {BASE}/users/{id}                        | TRUE  | admin, manager | Returns user details                                                                                                                     | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated<br/>403 - Unauthorized |
|            | PATCH  | {BASE}/users/{id}                        | TRUE  | admin          | Updates and returns user details                                                                                                         | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated<br/>403 - Unauthorized |
|            | DELETE | {BASE}/users/{id}                        | TRUE  | admin          | Deletes user                                                                                                                             | 204 - No content | 400 - Input invalid <br/>401 - Unauthenticated<br/>403 - Unauthorized |
| TEAM       | GET    | {BASE}/teams                             | TRUE  | everyone       | Returns all teams                                                                                                                        | 200 - OK         | 401 - Unauthenticated                                                 |
|            | POST   | {BASE}/teams                             | TRUE  | everyone       | Creates team                                                                                                                             | 201 - Created    | 400 - Input invalid<br/>401 - Unauthenticated                         |
|            | GET    | {BASE}/teams/{id}                        | TRUE  | everyone       | Returns team details                                                                                                                     | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | PATCH  | {BASE}/teams/{id}                        | TRUE  | everyone       | Updates and returns team details                                                                                                         | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | DELETE | {BASE}/teams/{id}                        | TRUE  | everyone       | Deletes team                                                                                                                             | 204 - No content | 400 - Input invalid <br/>401 - Unauthenticated                        |
| ROOM       | GET    | {BASE}/rooms                             | TRUE  | everyone       | Returns all rooms                                                                                                                        | 200 - OK         | 401 - Unauthenticated                                                 |
|            | POST   | {BASE}/rooms                             | TRUE  | everyone       | Creates room                                                                                                                             | 201 - Created    | 400 - Input invalid<br/>401 - Unauthenticated                         |
|            | GET    | {BASE}/rooms/{id}                        | TRUE  | everyone       | Returns room details                                                                                                                     | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | PATCH  | {BASE}/rooms/{id}                        | TRUE  | everyone       | Updates and returns room details                                                                                                         | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | DELETE | {BASE}/rooms/{id}                        | TRUE  | everyone       | Deletes room                                                                                                                             | 204 - No content | 400 - Input invalid <br/>401 - Unauthenticated                        |
| GAME       | GET    | {BASE}/games                             | TRUE  | everyone       | Returns all games                                                                                                                        | 200 - OK         | 401 - Unauthenticated                                                 |
|            | POST   | {BASE}/games                             | TRUE  | everyone       | Creates game                                                                                                                             | 201 - Created    | 400 - Input invalid<br/>401 - Unauthenticated                         |
|            | GET    | {BASE}/games/{id}                        | TRUE  | everyone       | Returns game details                                                                                                                     | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | PATCH  | {BASE}/games/{id}                        | TRUE  | everyone       | Updates and returns game details                                                                                                         | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | DELETE | {BASE}/games/{id}                        | TRUE  | everyone       | Deletes game                                                                                                                             | 204 - No content | 400 - Input invalid <br/>401 - Unauthenticated                        |
| TOPIC      | GET    | {BASE}/topics                            | FALSE | everyone       | Returns all topics                                                                                                                       | 200 - OK         |                                                                       |
|            | POST   | {BASE}/topics                            | TRUE  | admin, manager | Creates topic                                                                                                                            | 201 - Created    | 400 - Input invalid<br/>401 - Unauthenticated<br/>403 - Unauthorized  |
|            | GET    | {BASE}/topics/{id}                       | FALSE | everyone       | Returns topic details                                                                                                                    | 200 - OK         | 400 - Input invalid                                                   |
|            | PATCH  | {BASE}/topics/{id}                       | TRUE  | admin, manager | Updates and returns topic details                                                                                                        | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated<br/>403 - Unauthorized |
|            | DELETE | {BASE}/topics/{id}                       | TRUE  | admin, manager | Deletes topic                                                                                                                            | 204 - No content | 400 - Input invalid <br/>401 - Unauthenticated<br/>403 - Unauthorized |
| TEAM-USER  | GET    | {BASE}/teams/{team_id}/users             | TRUE  | everyone       | Returns all users in a team                                                                                                              | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | POST   | {BASE}/teams/{team_id}/users/{user_id}   | TRUE  | everyone       | Assigns user to team and returns user<br/>If body with valid virtual user data is provided, virtual user is created and assigned instead | 201 - Created    | 400 - Input invalid <br/>401 - Unauthenticated                        |
|            | DELETE | {BASE}/teams/{team_id}/users/{user_id}   | TRUE  | everyone       | Deletes user team relation                                                                                                               | 204 - No content | 400 - Input invalid <br/>401 - Unauthenticated                        |
| GAME-TEAM  | GET    | {BASE}/games/{game_id}/teams             | TRUE  | everyone       | Returns all teams to a game                                                                                                              | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
| USER-TEAM  | GET    | {BASE}/users/{user_id}/teams             | TRUE  | everyone       | Returns all teams to a user                                                                                                              | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
| USER-GAME  | GET    | {BASE}/users/{user_id}/games             | TRUE  | everyone       | Returns all games to a user                                                                                                              | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
| TOPIC-TERM | GET    | {BASE}/topics/{topic_id}/terms           | FALSE | everyone       | Returns all terms to a topic                                                                                                             | 200 - OK         | 400 - Input invalid                                                   |
|            | POST   | {BASE}/topics/{topic_id}/terms           | TRUE  | admin, manager | Creates term                                                                                                                             | 201 - Created    | 400 - Input invalid <br/>401 - Unauthenticated<br/>403 - Unauthorized |
|            | DELETE | {BASE}/topics/{topic_id}/terms/{term_id} | TRUE  | admin, manager | Deletes term                                                                                                                             | 204 - No content | 400 - Input invalid <br/>401 - Unauthenticated<br/>403 - Unauthorized |
| TOPIC-GAME | GET    | {BASE}/topics/{topic_id}/games           | TRUE  | everyone       | Returns all games to a topic                                                                                                             | 200 - OK         | 400 - Input invalid <br/>401 - Unauthenticated                        |
